# hw definition file for processing by chibios_hwdef.py
# for CUAV-X7 board

# MCU class and specific type
MCU STM32H7xx STM32H750xx

# crystal frequency
OSCILLATOR_HZ 8000000

MCU_CLOCKRATE_MHZ 480

# board ID for firmware load
APJ_BOARD_ID 10086

# limited flash that can't be used
FLASH_SIZE_KB 128
FLASH_RESERVE_START_KB 0
FLASH_RESERVE_END_KB 0
FLASH_BOOTLOADER_LOAD_KB 128

# 8mb external flash
EXT_FLASH_SIZE_MB 8
EXT_FLASH_RESERVE_START_KB 1024
EXT_FLASH_RESERVE_END_KB 448


# ChibiOS system timer
STM32_ST_USE_TIMER 15
define CH_CFG_ST_RESOLUTION 16

PE4 LED_BOOTLOADER OUTPUT OPENDRAIN HIGH # red
PE3 LED_ACTIVITY OUTPUT OPENDRAIN HIGH # green
PE5 LED_RED OUTPUT OPENDRAIN HIGH # blue
define HAL_LED_ON 0


# order of UARTs (and USB)
SERIAL_ORDER OTG1 

PA11 OTG_FS_DM OTG1
PA12 OTG_FS_DP OTG1
PA9  VBUS INPUT PULLDOWN

# PB6 USART1_TX USART1
# PB7 USART1_RX USART1

# PA2 USART2_TX USART2
# PA3 USART2_RX USART2

# PA0 UART4_TX UART4
# PA1 UART4_RX UART4

PA13 JTMS-SWDIO SWD
PA14 JTCK-SWCLK SWD

# QuadSPI Flash
PD11  QUADSPI_BK1_IO0 QUADSPI1 SPEED_HIGH
PD12  QUADSPI_BK1_IO1 QUADSPI1 SPEED_HIGH
PE2   QUADSPI_BK1_IO2 QUADSPI1 SPEED_HIGH
PD13  QUADSPI_BK1_IO3 QUADSPI1 SPEED_HIGH
PB10  QUADSPI_BK1_NCS QUADSPI1 SPEED_HIGH
PB2   QUADSPI_CLK     QUADSPI1 SPEED_HIGH

# IFace  Device Name  Bus      QSPI Mode  Clk Freq  Size (Pow2)  NCS Delay
QSPIDEV  w25q         QUADSPI1 MODE3      100*MHZ   23           1

define HAL_USE_EMPTY_STORAGE 1
define HAL_STORAGE_SIZE 16384

# Add CS pins to ensure they are high in bootloader
PE8   ICM_CS  CS
PE15  BARO_CS  CS
